/*
Copyright (c) 2015 mya-ake
Released under the MIT license
http://opensource.org/licenses/mit-license.php

Atrans.js Version 1.0.2
*/
var atrans=function(){function a(){function a(a,b){return void 0===h.contents[a]?null:void 0===h.contents[a][b]?null:h.contents[a][b]}function b(a,b,c,d){h.getContent(a,b,c,d)}function c(a,b,c,d){var e=f(a,b),i=document.getElementById(h.areas[b].id);"undefined"==typeof e||null===i?h.getContent(a,b,c,d):(i.innerHTML=e,h.addEventLink(l+a),g(a,c,d),h.afterTrans(document.getElementById(l+a),a,b))}function d(a,b,c,d){var e=document.getElementById(l+a);null===e?h.getContent(a,b,c,d):(g(a,c,d),h.afterTrans(e,a,b))}function e(a,b,c){var d=h.areas[c].cache;switch("string"!=typeof d&&(d=i.states.cache),d){case o:sessionStorage[l+b]=a.outerHTML;break;case p:localStorage[l+b]=a.outerHTML}}function f(a,b){var c=h.areas[b].cache;switch("string"!=typeof c&&(c=i.states.cache),c){case o:return sessionStorage[l+a];case p:return localStorage[l+a];default:return}}function g(a,b,c){i.states.useHistory===!0&&b===!0&&h.addHistory(a),c===!0&&h.analytics(),h.setTitle(a),h.setDescription(a)}var h={},i={};const j="default",k="elem-atrans",l="atrans-",m="none",n="dom",o="session",p="local";return h.content=j,h.E_ATRANS=k,h.PREFIX=l,h.cache={C_NONE:m,C_DOM:n,C_SESSION:o,C_LOCAL:p},h.contents={DEF:{path:"",url:null,title:"",description:""}},h.areas={DEF:{id:"main",tag:"div",permanence:!1,cache:n}},i.datas={timeout:5e3},i.states={useHistory:!0,useTimeout:!1,cache:n},h.beforeTrans=function(a,b){var c=h.areas[b].cache;switch("string"!=typeof c&&(c=i.states.cache),c){case h.cache.C_DOM:h.hiddenAll(b);break;default:h.removeAll(b)}},h.success=function(a,b,c){},h.failure=function(a,b){},h.complete=function(a,b){},h.timeout=function(a,b){},h.afterTrans=function(a,b,c){h.showElem(a)},h.onpopstate=function(a){atrans.trans(a,null,!1,!1)},h.analytics=function(){},h.setCache=function(a){i.states.cache=a.toLowerCase()},h.setHistory=function(a){i.states.useHistory=a},h.setTimeout=function(a,b){i.states.useTimeout=a,"number"==typeof b&&(i.datas.timeout=b)},h.init=function(a,e){"string"!=typeof a&&(a=h.getContentName()),"string"!=typeof e&&(e=j),i.states.useHistory===!0&&(h.initUrl(a),h.setOnpopstate());var f=h.areas[e].cache;switch("string"!=typeof f&&(f=i.states.cache),f){case m:b(a,e);break;case o:case p:c(a,e);break;case n:d(a,e)}e===j&&(h.content=a)},h.getContentName=function(){var a=window.location.pathname;for(var b in h.contents){if(h.contents[b].path===a)return b;if(h.contents[b].url===a)return b}return j},h.trans=function(a,e,f,g){"string"!=typeof a&&(a=h.getContentName()),"string"!=typeof e&&(e=j),h.beforeTrans(a,e);var k=h.areas[e].cache;switch("string"!=typeof k&&(k=i.states.cache),k){case m:b(a,e,f,g);break;case o:case p:c(a,e,f,g);break;case n:d(a,e,f,g)}e===j&&(h.content=a,window.scrollTo(0,0))},h.initUrl=function(b){var c=a(b,"url");return c=null===c?a(b,"path"):c,null===c?!1:(window.history.replaceState({content:b},"",c),!0)},h.addHistory=function(b){var c=a(b,"url");return c=null===c?a(b,"path"):c,null===c?!1:(window.history.pushState({content:b},"",c),!0)},h.getContent=function(b,c,d,f){var j=a(b,"path"),k=new XMLHttpRequest;k.open("GET",j,!0),i.states.useTimeout===!0&&void 0!==k.timeout&&(k.ontimeout=function(){h.timeout(b,c)},k.timeout=i.datas.timeout),k.onreadystatechange=function(){switch(k.readyState){case 3:break;case 4:var a=null;200<=k.status&&k.status<300||304==k.status?(a=h.appendHtml(h.getBodyInnerHtml(k.response),h.areas[c],b),h.addEventLink(l+b),g(b,d,f),h.success(a,b,c),e(a,b,c)):h.failure(b,c),h.complete(b,c),null!==a&&h.afterTrans(a,b,c)}},k.send()},h.appendHtml=function(a,b,c){var d=document.getElementById(b.id);if(null!==d){var e=document.createElement(b.tag);return e.insertAdjacentHTML("beforeend",a),b.permanence===!1&&(e.className=k),"string"==typeof c&&(e.id=l+c),d.appendChild(e),e}},h.getBodyInnerHtml=function(a){return a.replace(/[\s\S]*<body>([\s\S]*)<\/body>[\s\S]*/m,"$1")},h.hiddenAll=function(a){var b=document;"string"==typeof a&&(b=document.getElementById(h.areas[a].id));for(var c=b.getElementsByClassName(k),d=c.length-1;d>=0;d--)c[d].style.display="none"},h.removeAll=function(a){var b=document;"string"==typeof a&&(b=document.getElementById(h.areas[a].id));for(var c=b.getElementsByClassName(k),d=c.length-1;d>=0;d--)c[d]&&c[d].parentElement&&c[d].parentElement.removeChild(c[d])},h.showElem=function(a,b){"string"!=typeof b&&(b="block"),a.style.display=b},h.setTitle=function(b){var c=a(b,"title");null!==c&&""!==c&&(document.title=c)},h.setDescription=function(b){var c=a(b,"description");if(null!==c&&""!==c){var d=document.getElementsByName("description");null!==d&&d[0].setAttribute("content",c)}},h.setOnpopstate=function(){function a(){var a=window.history.state;null!==a&&h.onpopstate(a.content)}window.addEventListener("popstate",a,!1)},h.sessionClear=function(a){"string"==typeof a?sessionStorage.removeItem(l+a):sessionStorage.clear()},h.localClear=function(a){"string"==typeof a?localStorage.removeItem(l+a):localStorage.clear()},h.addEventLink=function(a){function b(a){var b=this.getAttribute("data-atlink"),c=this.getAttribute("data-atarea");h.content!==b&&h.trans(b,c,!0,!0),a.preventDefault()}var c=document;"string"==typeof a&&(c=document.getElementById(a));for(var d=c.getElementsByClassName("atrans-link"),e=d.length-1;e>=0;e--)d[e].addEventListener("click",b,!1)},h.appendJs=function(a,b){var c=document.createElement("script");c.src=a,b!==!1&&(c.async=1),document.getElementsByTagName("head")[0].appendChild(c)},h.appendCss=function(a){var b=document.createElement("link");b.href=a,b.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(b)},h.getBasePath=function(a){var b=new RegExp("(/"+a+")/.*");return window.location.pathname.replace(b,"$1")},h}return new a}();